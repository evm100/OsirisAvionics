//Blue Raven/ESP 32 Interface code 
// Example: ESP32 UART to Blue Raven
#include <HardwareSerial.h>

HardwareSerial BRSerial(2);  // Use Serial2

void setup() {
  Serial.begin(115200);   // Debug on USB
  BRSerial.begin(115200, SERIAL_8N1, /* RX */ 16, /* TX */ 17);

  delay(1000);
  Serial.println("Blue Raven Reader Ready");
  sendCommand("<download l>");  // Request low-rate data
}

void loop() {
  // Read from Blue Raven and print to USB
  while (BRSerial.available()) {
    char c = BRSerial.read();
    Serial.write(c);
  }

  // Optionally read from USB and forward to Blue Raven
  if (Serial.available()) {
    char in = Serial.read();
    BRSerial.write(in);
  }
}

void sendCommand(const char* cmd) {
  BRSerial.print(cmd);
  BRSerial.print("\r\n");  // Commands end with CR/LF
  Serial.print("Sent: ");
  Serial.println(cmd);
}
